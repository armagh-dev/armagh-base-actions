{{-@doc.with 'data' do}}
{{-@doc.with 'customer' do}}
{{=Armagh::Support::Templating.header 'Customer'}}

{{=Armagh::Support::Templating.block_begin-}}
  {{=Armagh::Support::Templating.field 'Customer ID', @doc.get('attr_id')}}
  {{=Armagh::Support::Templating.field 'Name', @doc.concat('@name.first @name.middle @name.last', allow_missing: true)}}
  {{-@doc.with 'address' do}}{{=Armagh::Support::Templating.field 'Address', @doc.concat('@street, @unit, @city, @state  @zip')}}{{-end}}
{{=Armagh::Support::Templating.block_next-}}
  {{=Armagh::Support::Templating.field 'Last Order Date', @doc.get('last_order_date', default: 'N/A')}}
  {{=Armagh::Support::Templating.field 'Notes', @doc.get('notes', allow_missing: true, default: 'None')}}
{{=Armagh::Support::Templating.block_end-}}

{{-if Armagh::Support::Templating.mode == :text}}
  This content is for text mode only
{{-elsif Armagh::Support::Templating.mode == :html}}
  This content is for html mode only
{{-end}}
{{-end # customer}}

{{-@doc.with 'orders' do}}
{{=Armagh::Support::Templating.header 'Orders (' + @doc.get('attr_total') + ' total)'}}

{{-@doc.loop 'order', show_empty: true do |i|}}
{{=Armagh::Support::Templating.block_from_int i-}}
  {{=Armagh::Support::Templating.field 'Order #', i}}
  {{=Armagh::Support::Templating.field 'Item', @doc.get('item')}}
  {{=Armagh::Support::Templating.field 'Total Price', @doc.get('total_price')}}
  {{=Armagh::Support::Templating.field 'Shipping Method', @doc.enum('shipping_method', '1'=>'Ground', '2'=>'Two-Day Air', '3'=>'One-Day Air', nil=>'Other', format: '%s - %s')}}

{{-end # loop}}
{{=Armagh::Support::Templating.block_end-}}
{{-end # orders}}
{{-end # root}}
